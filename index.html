<!DOCTYPE html>
<html lang="fr">
<head>
    <!-- Firebase App (obligatoire) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    
    <!-- Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyDN8pOUrRGbpatuYRwLQqFPeRzWNJphgaw",
        authDomain: "page-synchrone.firebaseapp.com",
        projectId: "page-synchrone",
        storageBucket: "page-synchrone.firebasestorage.app",
        messagingSenderId: "227545744120",
        appId: "1:227545744120:web:c313a7c4a5c6c541d8f10d"
      };
    
      // Initialiser Firebase
      firebase.initializeApp(firebaseConfig);
    
      // Accès à la base Firestore
      const db = firebase.firestore();
    </script>

    <meta charset="UTF-8">
    <title>Killer Party</title>

    <!-- Important pour le mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #f5f5f5;
            font-family: Arial, sans-serif;
        }

        .container {
            text-align: center;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        button {
            font-size: 1.2rem;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            background: #007bff;
            color: white;
            cursor: pointer;
        }

        button:active {
            transform: scale(0.98);
        }

        /* Overlay plein écran */
        #overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0,0,0,0.9);
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: flex;
        }

        #overlay img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Killer Party</h1>
    <select id="prenom">
        <option value="">Choisir votre prénom</option>
        <option value="Angelo">Angelo</option>
        <option value="Vinciane">Vinciane</option>
        <option value="Coraline">Coraline</option>
        <option value="Jason">Jason</option>
        <option value="Kelly">Kelly</option>
        <option value="Nathan">Nathan</option>
    </select>
    <br><br>
    <button id="btn" disabled>Lancer le jeu</button>
</div>
<div id="overlay" onclick="fermerImage()">
    <img src="image.jpg" alt="Image plein écran">
</div>
    
<script>
const btn = document.getElementById("btn");
const prenomSelect = document.getElementById("prenom");

// Générer un ID aléatoire pour chaque visiteur
const userId = 'user-' + Math.random().toString(36).substr(2, 9);
const userRef = db.collection('participants').doc(userId);

// Mettre à jour le prénom et prêt quand on choisit
prenomSelect.addEventListener('change', () => {
    const prenom = prenomSelect.value;
    if (prenom) {
        userRef.set({
            prenom: prenom,
            pret: true
        });
    } else {
        userRef.set({
            prenom: "",
            pret: false
        });
    }
});

// Écoute en temps réel
db.collection('participants').onSnapshot(snapshot => {
    let count = 0;
    snapshot.forEach(doc => {
        if (doc.data().pret) count++;
    });

    if (count >= 2) {
        btn.disabled = false;
    } else {
        btn.disabled = true;
    }
});

// Bouton pour afficher l'image en plein écran
function ouvrirImage() {
    document.getElementById("overlay").style.display = "flex";
}

function fermerImage() {
    document.getElementById("overlay").style.display = "none";
}
</script>


</body>
</html>
